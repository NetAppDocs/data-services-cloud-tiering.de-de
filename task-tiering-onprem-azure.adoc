---
sidebar: sidebar 
permalink: task-tiering-onprem-azure.html 
keywords: data tiering, fabricpool, cloud tiering, tiering cold data, tiering inactive data, tiering aff, tiering fas, tiering ontap, tiering volumes, tier data, tier cold data, tier fas, tier aff, tier ontap, azure, blob, azure blob 
summary: Geben Sie Speicherplatz auf Ihren lokalen ONTAP Clustern frei, indem Sie inaktive Daten in Azure Blob Storage auslagern. 
---
= Daten von lokalen ONTAP -Clustern in Azure Blob Storage in NetApp Cloud Tiering verschieben
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Geben Sie Speicherplatz auf Ihren lokalen ONTAP Clustern frei, indem Sie inaktive Daten in Azure Blob Storage auslagern.  Geben Sie Speicherplatz auf Ihren lokalen ONTAP Clustern frei, indem Sie inaktive Daten in Azure Blob Storage auslagern.



== Schnellstart

Beginnen Sie schnell, indem Sie diese Schritte befolgen, oder scrollen Sie nach unten zu den restlichen Abschnitten, um alle Einzelheiten zu erfahren.

.image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-1.png["Eins"]Vorbereiten der Datenauslagerung in Azure Blob Storage
[role="quick-margin-para"]
Sie benötigen Folgendes:

[role="quick-margin-list"]
* Ein lokaler ONTAP -Quellcluster mit ONTAP 9.4 oder höher, den Sie der NetApp Konsole hinzugefügt haben, und eine HTTPS-Verbindung zum Azure Blob-Speicher. https://docs.netapp.com/us-en/bluexp-ontap-onprem/task-discovering-ontap.html["Erfahren Sie, wie Sie einen Cluster erkennen"^] .
* Ein Konsolenagent, der in einem Azure VNet oder bei Ihnen vor Ort installiert ist.
* Netzwerk für einen Agenten, der eine ausgehende HTTPS-Verbindung zum ONTAP Cluster in Ihrem Rechenzentrum, zum Azure-Speicher und zum Cloud Tiering-Dienst ermöglicht.


.image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-2.png["Zwei"]Einrichten von Tiering
[role="quick-margin-para"]
Wählen Sie in der NetApp Konsole ein lokales ONTAP -System aus, wählen Sie *Aktivieren* für den Tiering-Dienst und folgen Sie den Anweisungen, um die Daten in den Azure Blob-Speicher zu verschieben.

.image:https://raw.githubusercontent.com/NetAppDocs/common/main/media/number-3.png["Drei"]Einrichten der Lizenzierung
[role="quick-margin-para"]
Nach Ablauf Ihrer kostenlosen Testversion bezahlen Sie für Cloud Tiering über ein Pay-as-you-go-Abonnement, eine ONTAP Cloud Tiering BYOL-Lizenz oder eine Kombination aus beidem:

[role="quick-margin-list"]
* Um ein Abonnement über den Azure Marketplace abzuschließen, https://azuremarketplace.microsoft.com/en-us/marketplace/apps/netapp.cloud-manager?tab=Overview["zum Marketplace-Angebot"^] , wählen Sie *Abonnieren* und folgen Sie dann den Anweisungen.
* Um mit einer Cloud Tiering BYOL-Lizenz zu bezahlen, mailto:ng-cloud-tiering@netapp.com?subject=Licensing[kontaktieren Sie uns, wenn Sie eine kaufen müssen], und dannlink:https://docs.netapp.com/us-en/bluexp-digital-wallet/task-manage-data-services-licenses.html["Fügen Sie es der NetApp Konsole hinzu"] .




== Anforderungen

Überprüfen Sie die Unterstützung für Ihren ONTAP Cluster, richten Sie Ihr Netzwerk ein und bereiten Sie Ihren Objektspeicher vor.

Das folgende Bild zeigt jede Komponente und die Verbindungen, die Sie zwischen ihnen vorbereiten müssen:

image:diagram_cloud_tiering_azure.png["Ein Architekturbild, das den Cloud Tiering-Dienst mit einer Verbindung zum Konsolenagenten in Ihrem Cloud-Anbieter, den Agenten mit einer Verbindung zu Ihrem ONTAP Cluster und eine Verbindung zwischen dem ONTAP Cluster und dem Objektspeicher in Ihrem Cloud-Anbieter zeigt.  Aktive Daten befinden sich auf dem ONTAP Cluster, während inaktive Daten im Objektspeicher gespeichert sind."]


NOTE: Die Kommunikation zwischen dem Konsolenagenten und dem Blob-Speicher dient nur der Einrichtung des Objektspeichers.  Der Agent kann sich in Ihren Räumlichkeiten statt in der Cloud befinden.



=== Bereiten Sie Ihre ONTAP -Cluster vor

Ihre ONTAP -Cluster müssen beim Tiering von Daten in Azure Blob Storage die folgenden Anforderungen erfüllen.

Unterstützte ONTAP -Plattformen::
+
--
* Bei Verwendung von ONTAP 9.8 und höher: Sie können Daten von AFF -Systemen oder FAS Systemen mit reinen SSD- oder reinen HDD-Aggregaten stufen.
* Bei Verwendung von ONTAP 9.7 und früher: Sie können Daten von AFF -Systemen oder FAS Systemen mit reinen SSD-Aggregaten stufen.


--
Unterstützte ONTAP -Version:: ONTAP 9.4 oder höher
Cluster-Netzwerkanforderungen::
+
--
* Der ONTAP Cluster initiiert über Port 443 eine HTTPS-Verbindung zum Azure Blob-Speicher.
+
ONTAP liest und schreibt Daten in den und aus dem Objektspeicher.  Der Objektspeicher wird nie initiiert, er reagiert nur.

+
Obwohl ExpressRoute eine bessere Leistung und niedrigere Datenübertragungsgebühren bietet, ist es zwischen dem ONTAP -Cluster und dem Azure Blob-Speicher nicht erforderlich.  Dies ist jedoch die empfohlene Vorgehensweise.

* Vom Agenten ist eine eingehende Verbindung erforderlich, die sich in einem Azure VNet oder bei Ihnen vor Ort befinden kann.
+
Eine Verbindung zwischen dem Cluster und dem Cloud Tiering-Dienst ist nicht erforderlich.

* Auf jedem ONTAP Knoten, der die Volumes hostet, die Sie in ein Tiering einteilen möchten, ist ein Intercluster-LIF erforderlich.  Das LIF muss mit dem _IPspace_ verknüpft sein, den ONTAP für die Verbindung mit dem Objektspeicher verwenden soll.
+
Wenn Sie die Datenschichtung einrichten, werden Sie von Cloud Tiering aufgefordert, den zu verwendenden IP-Bereich anzugeben.  Sie sollten den IPspace auswählen, mit dem jedes LIF verknüpft ist.  Dies kann der „Standard“-IP-Bereich oder ein benutzerdefinierter IP-Bereich sein, den Sie erstellt haben.  Erfahren Sie mehr über https://docs.netapp.com/us-en/ontap/networking/create_a_lif.html["LIFs"^] Und https://docs.netapp.com/us-en/ontap/networking/standard_properties_of_ipspaces.html["IPspaces"^] .



--
Unterstützte Volumes und Aggregate:: Die Gesamtzahl der Volumes, die Cloud Tiering in Tiering einteilen kann, ist möglicherweise geringer als die Anzahl der Volumes auf Ihrem ONTAP System.  Das liegt daran, dass Volumes aus einigen Aggregaten nicht gestaffelt werden können.  Weitere Informationen finden Sie in der ONTAP -Dokumentation. https://docs.netapp.com/us-en/ontap/fabricpool/requirements-concept.html#functionality-or-features-not-supported-by-fabricpool["Funktionen oder Features, die von FabricPool nicht unterstützt werden"^] .



NOTE: Cloud Tiering unterstützt FlexGroup -Volumes ab ONTAP 9.5.  Die Einrichtung funktioniert genauso wie bei jedem anderen Volume.



=== Entdecken Sie einen ONTAP -Cluster

Sie müssen der NetApp Konsole ein lokales ONTAP -System hinzufügen, bevor Sie mit dem Tiering kalter Daten beginnen können.

https://docs.netapp.com/us-en/bluexp-ontap-onprem/task-discovering-ontap.html["Erfahren Sie, wie Sie einen Cluster erkennen"^] .



=== Agenten erstellen oder wechseln

Zum Verteilen der Daten in die Cloud ist ein Agent erforderlich.  Beim Tiering von Daten in Azure Blob Storage können Sie einen Agenten verwenden, der sich in einem Azure VNet oder an Ihrem Standort befindet.  Sie müssen entweder einen neuen Agenten erstellen und sicherstellen, dass sich der aktuell ausgewählte Agent in Azure oder vor Ort befindet.

* https://docs.netapp.com/us-en/bluexp-setup-admin/concept-connectors.html["Erfahren Sie mehr über Agenten"^]
* https://docs.netapp.com/us-en/bluexp-setup-admin/task-quick-start-connector-azure.html["Bereitstellen eines Agenten in Azure"^]
* https://docs.netapp.com/us-en/bluexp-setup-admin/task-quick-start-connector-on-prem.html["Installieren eines Agenten auf einem Linux-Host"^]




=== Stellen Sie sicher, dass Sie über die erforderlichen Agentenberechtigungen verfügen

Wenn Sie den Konsolenagenten mit Version 3.9.25 oder höher erstellt haben, sind Sie fertig.  Die benutzerdefinierte Rolle, die die Berechtigungen bereitstellt, die ein Agent zum Verwalten von Ressourcen und Prozessen in Ihrem Azure-Netzwerk benötigt, wird standardmäßig eingerichtet.  Siehe die https://docs.netapp.com/us-en/bluexp-setup-admin/reference-permissions-azure.html#custom-role-permissions["erforderliche benutzerdefinierte Rollenberechtigungen"^] und die https://docs.netapp.com/us-en/bluexp-setup-admin/reference-permissions-azure.html#cloud-tiering["Für Cloud Tiering sind bestimmte Berechtigungen erforderlich"^] .

Wenn Sie den Agenten mit einer früheren Version erstellt haben, müssen Sie die Berechtigungsliste für das Azure-Konto bearbeiten, um fehlende Berechtigungen hinzuzufügen.



=== Vorbereiten des Netzwerks für den Konsolenagenten

Stellen Sie sicher, dass der Konsolenagent über die erforderlichen Netzwerkverbindungen verfügt.  Der Agent kann vor Ort oder in Azure installiert werden.

.Schritte
. Stellen Sie sicher, dass das Netzwerk, in dem der Agent installiert ist, die folgenden Verbindungen ermöglicht:
+
** Eine HTTPS-Verbindung über Port 443 zum Cloud Tiering-Dienst und zu Ihrem Azure Blob-Objektspeicher(https://docs.netapp.com/us-en/bluexp-setup-admin/task-set-up-networking-azure.html#endpoints-contacted-for-day-to-day-operations["siehe die Liste der Endpunkte"^] )
** Eine HTTPS-Verbindung über Port 443 zu Ihrem ONTAP Cluster-Management-LIF


. Aktivieren Sie bei Bedarf einen VNet-Dienstendpunkt für Azure Storage.
+
Ein VNet-Dienstendpunkt zum Azure-Speicher wird empfohlen, wenn Sie über eine ExpressRoute- oder VPN-Verbindung von Ihrem ONTAP Cluster zum VNet verfügen und die Kommunikation zwischen dem Agenten und dem Blob-Speicher in Ihrem virtuellen privaten Netzwerk bleiben soll.





=== Vorbereiten des Azure Blob-Speichers

Wenn Sie das Tiering einrichten, müssen Sie die Ressourcengruppe identifizieren, die Sie verwenden möchten, sowie das Speicherkonto und den Azure-Container, die zur Ressourcengruppe gehören.  Ein Speicherkonto ermöglicht Cloud Tiering die Authentifizierung und den Zugriff auf den für das Data Tiering verwendeten Blob-Container.

Cloud Tiering unterstützt die Tiering-Funktion für jedes Speicherkonto in jeder Region, auf das über den Agenten zugegriffen werden kann.

Cloud Tiering unterstützt nur die Speicherkontotypen General Purpose v2 und Premium Block Blob.


NOTE: Wenn Sie Cloud Tiering so konfigurieren möchten, dass eine kostengünstigere Zugriffsebene verwendet wird, auf die Ihre mehrstufigen Daten nach einer bestimmten Anzahl von Tagen übertragen werden, dürfen Sie beim Einrichten des Containers in Ihrem Azure-Konto keine Lebenszyklusregeln auswählen.  Cloud Tiering verwaltet die Lebenszyklusübergänge.



== Tiering inaktiver Daten aus Ihrem ersten Cluster in Azure Blob Storage

Nachdem Sie Ihre Azure-Umgebung vorbereitet haben, beginnen Sie mit dem Tiering inaktiver Daten aus Ihrem ersten Cluster.

.Was du brauchst
https://docs.netapp.com/us-en/bluexp-ontap-onprem/task-discovering-ontap.html["Ein lokales ONTAP -System zur NetApp -Konsole"^] .

.Schritte
. Wählen Sie das lokale ONTAP -System aus.
. Klicken Sie im rechten Bereich auf *Aktivieren* für den Tiering-Dienst.
+
Wenn das Azure Blob-Tieringziel als System auf der Seite „Systeme“ vorhanden ist, können Sie den Cluster auf das Azure Blob-System ziehen, um den Setup-Assistenten zu starten.

+
image:screenshot_setup_tiering_onprem.png["Ein Screenshot, der die Option „Aktivieren“ zeigt, die auf der rechten Seite des Bildschirms angezeigt wird, nachdem Sie ein lokales ONTAP -System ausgewählt haben."]

. *Name des Objektspeichers definieren*: Geben Sie einen Namen für diesen Objektspeicher ein.  Es muss sich von allen anderen Objektspeichern unterscheiden, die Sie möglicherweise mit Aggregaten auf diesem Cluster verwenden.
. *Anbieter auswählen*: Wählen Sie *Microsoft Azure* und dann *Weiter*.
. *Anbieter auswählen*: Wählen Sie *Microsoft Azure* und dann *Weiter*.
. Führen Sie die Schritte auf den Seiten *Objektspeicher erstellen* aus:
+
.. *Ressourcengruppe*: Wählen Sie eine Ressourcengruppe aus, in der ein vorhandener Container verwaltet wird oder in der Sie einen neuen Container für mehrstufige Daten erstellen möchten, und wählen Sie *Weiter*.
.. *Ressourcengruppe*: Wählen Sie eine Ressourcengruppe aus, in der ein vorhandener Container verwaltet wird oder in der Sie einen neuen Container für mehrstufige Daten erstellen möchten, und wählen Sie *Weiter*.
+
Wenn Sie einen lokalen Agenten verwenden, müssen Sie das Azure-Abonnement eingeben, das Zugriff auf die Ressourcengruppe bietet.

.. *Azure-Container*: Wählen Sie das Optionsfeld aus, um einem Speicherkonto entweder einen neuen Blob-Container hinzuzufügen oder einen vorhandenen Container zu verwenden.  Wählen Sie dann das Speicherkonto aus und wählen Sie den vorhandenen Container aus oder geben Sie den Namen für den neuen Container ein.  Wählen Sie dann *Weiter*.
.. *Azure-Container*: Wählen Sie das Optionsfeld aus, um einem Speicherkonto entweder einen neuen Blob-Container hinzuzufügen oder einen vorhandenen Container zu verwenden.  Wählen Sie dann das Speicherkonto aus und wählen Sie den vorhandenen Container aus oder geben Sie den Namen für den neuen Container ein.  Wählen Sie dann *Weiter*.
+
Die in diesem Schritt angezeigten Speicherkonten und Container gehören zu der Ressourcengruppe, die Sie im vorherigen Schritt ausgewählt haben.

.. *Lebenszyklus der Zugriffsebene*: Cloud Tiering verwaltet die Lebenszyklusübergänge Ihrer mehrstufigen Daten.  Die Daten beginnen in der Klasse _Hot_, Sie können jedoch eine Regel erstellen, um nach einer bestimmten Anzahl von Tagen die Klasse _Cool_ auf die Daten anzuwenden.
+
Wählen Sie die Zugriffsebene aus, auf die Sie die abgestuften Daten übertragen möchten, und die Anzahl der Tage, bevor die Daten dieser Ebene zugewiesen werden, und wählen Sie *Weiter* aus.  Der folgende Screenshot zeigt beispielsweise, dass abgestufte Daten nach 45 Tagen im Objektspeicher von der Klasse _Hot_ der Klasse _Cool_ zugewiesen werden.

+
Wenn Sie *Daten in dieser Zugriffsebene behalten* wählen, verbleiben die Daten in der _Hot_-Zugriffsebene und es werden keine Regeln angewendet. link:reference-azure-support.html["Siehe unterstützte Zugriffsebenen"^] .

+
image:screenshot_tiering_lifecycle_selection_azure.png["Ein Screenshot, der zeigt, wie Sie eine andere Zugriffsebene auswählen, die Ihren Daten nach einer bestimmten Anzahl von Tagen zugewiesen wird."]

+
Beachten Sie, dass die Lebenszyklusregel auf alle Blobcontainer im ausgewählten Speicherkonto angewendet wird.

.. *Cluster-Netzwerk*: Wählen Sie den IP-Bereich aus, den ONTAP für die Verbindung mit dem Objektspeicher verwenden soll, und wählen Sie *Weiter*.
+
Durch die Auswahl des richtigen IP-Bereichs wird sichergestellt, dass Cloud Tiering eine Verbindung von ONTAP zum Objektspeicher Ihres Cloud-Anbieters herstellen kann.

+
Sie können auch die zum Hochladen inaktiver Daten in den Objektspeicher verfügbare Netzwerkbandbreite festlegen, indem Sie die „Maximale Übertragungsrate“ definieren.  Wählen Sie das Optionsfeld *Begrenzt* und geben Sie die maximal nutzbare Bandbreite ein, oder wählen Sie *Unbegrenzt*, um anzugeben, dass keine Begrenzung besteht.



. Wählen Sie auf der Seite „Tier Volumes“ die Volumes aus, für die Sie Tiering konfigurieren möchten, und starten Sie die Seite „Tiering Policy“:
+
** Um alle Bände auszuwählen, aktivieren Sie das Kontrollkästchen in der Titelzeile (image:button_backup_all_volumes.png[""] ) und wählen Sie *Volumes konfigurieren*.
** Um mehrere Volumes auszuwählen, aktivieren Sie das Kontrollkästchen für jedes Volume (image:button_backup_1_volume.png[""] ) und wählen Sie *Volumes konfigurieren*.
** Um ein einzelnes Volume auszuwählen, wählen Sie die Zeile (oderimage:screenshot_edit_icon.gif["Bleistiftsymbol bearbeiten"] Symbol) für die Lautstärke.
+
image:screenshot_tiering_initial_volumes.png["Ein Screenshot, der zeigt, wie Sie ein einzelnes Volume, mehrere Volumes oder alle Volumes auswählen und die Schaltfläche „Ausgewählte Volumes ändern“ verwenden."]



. Wählen Sie im Dialogfeld „Tiering-Richtlinie“ eine Tiering-Richtlinie aus, passen Sie optional die Kühltage für die ausgewählten Volumes an und wählen Sie „Übernehmen“ aus.
+
link:concept-cloud-tiering.html#volume-tiering-policies["Erfahren Sie mehr über Volumenstaffelungsrichtlinien und Kühltage"] .

+
image:screenshot_tiering_initial_policy_settings.png["Ein Screenshot, der die konfigurierbaren Tiering-Richtlinieneinstellungen zeigt."]



.Ergebnis
Sie haben die Datenschichtung von Volumes im Cluster zum Azure Blob-Objektspeicher erfolgreich eingerichtet.

.Wie geht es weiter?
link:task-licensing-cloud-tiering.html["Abonnieren Sie unbedingt den Cloud Tiering-Dienst"] .

Sie können Informationen zu den aktiven und inaktiven Daten auf dem Cluster überprüfen. link:task-managing-tiering.html["Erfahren Sie mehr über die Verwaltung Ihrer Tiering-Einstellungen"] .

Sie können auch zusätzlichen Objektspeicher erstellen, wenn Sie Daten aus bestimmten Aggregaten eines Clusters auf verschiedene Objektspeicher verteilen möchten.  Oder wenn Sie FabricPool Mirroring verwenden möchten, bei dem Ihre mehrstufigen Daten in einen zusätzlichen Objektspeicher repliziert werden. link:task-managing-object-storage.html["Weitere Informationen zur Verwaltung von Objektspeichern"] .
